---
title: "KNN"
author: "Steve Newns"
date: "November 2, 2017"
output: html_document
---
# Recognizing a road sign with kNN

dataset = `signs` (labels of sign type + color vectors) + dataframe `next_sign` = 1 observation you want to classify (only)

Each observed street sign = divided into a 4x4 grid, + the R, G, + B level for each of the 16 center pixels is recorded

Result = a dataset that records `sign_type` as well as 16 x 3 = 48 color properties of each sign.

```{r}
# Load the 'class' package for KNNM
library(class)

# Create a vector of labels
sign_types <- signs$sign_type

# Classify the next sign observed - remove label from training set, test on 1 observation w/ labels extracted above
knn(train = signs[-1], test = next_sign, cl = sign_types)
```

Predicts stop = test sign was in some way similar to another stop sign


```{r}
# Examine the structure of the signs dataset
str(signs)

# Count the number of signs of each type
table(signs$sign_type)

# Check average red level in pixel 10 by sign type
aggregate(r10 ~ sign_type, data = signs, mean)
```
stop sign has highest average red value in pixel 10 = how kNN identifies similar signs.

Test course includes 59 additional road signs divided into 3 types --> measure car's overall performance at recognizing these signs.

```{r}
# Use kNN to ID the test road signs
sign_types <- signs$sign_type
signs_pred <- knn(train = signs[-1], test = test_signs[-1], cl = sign_types)

# Create confusion matrix of the actual vs predicted values
signs_actual <- test_signs$sign_type
table(signs_pred, signs_actual)

# Compute the accuracy
mean(signs_actual == signs_pred)
```