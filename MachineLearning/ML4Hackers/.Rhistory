data.frame(Logit = ifelse(predict(logistic_model) > 0, 1, 0), # logistic regression prediction
SVM = ifelse(predict(svm_model) > 0, 1, 0))) # SVM prediction
head(df)
# create new df where cols melt into single col's values
predictions <- melt(df, id.vars = c('X', 'Y'))
head(predictions)
ggplot(predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
# reset df
df <- df[, c('X', 'Y', 'Label')]
linear_svm <- svm(Label ~ X + Y, df, kernel = 'linear')
with(df, mean(Label == ifelse(predict(linear_svm) > 0, 1, 0)))
polynomial_svm <- svm(Label ~ X + Y, df, kernel = 'polynomial')
with(df, mean(Label == ifelse(predict(polynomial_svm) > 0, 1, 0)))
radial_svm <- svm(Label ~ X + Y, df, kernel = 'radial')
with(df, mean(Label == ifelse(predict(radial_svm) > 0, 1, 0)))
sigmoid_svm <- svm(Label ~ X + Y, df, kernel = 'sigmoid')
with(df, mean(Label == ifelse(predict(sigmoid_svm) > 0, 1, 0)))
df <- cbind(df, data.frame(LinearSVM = ifelse(predict(linear_svm) > 0, 1, 0),
PolynomialSVM = ifelse(predict(polynomial_svm) > 0, 1, 0),
RadialSVM = ifelse(predict(radial_svm) > 0, 1, 0),
SigmoidSVM = ifelse(predict(sigmoid_svm) > 0, 1, 0)))
# melt each SVM col into single col
predictions <- melt(df, id.vars = c('X', 'Y'))
ggplot(predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_polynomialD3 <- svm(Label ~ X + Y, df, kernel = 'polynomial', degree = 3)
paste("3rd degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD3) > 0, 1, 0))))
svm_model_polynomialD5 <- svm(Label ~ X + Y, df, kernel = 'polynomial', degree = 5)
paste("5th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD5) > 0, 1, 0))))
svm_model_polynomialD10 <- svm(Label ~ X + Y, df, kernel = 'polynomial', degree = 10)
paste("10th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD10) > 0, 1, 0))))
svm_model_polynomialD12 <- svm(Label ~ X + Y, df, kernel = 'polynomial', degree = 12)
paste("12th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD12) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(Degree3SVM = ifelse(predict(svm_model_polynomialD3) > 0, 1, 0),
Degree5SVM = ifelse(predict(svm_model_polynomialD5) > 0, 1, 0),
Degree10SVM = ifelse(predict(svm_model_polynomialD10) > 0, 1, 0),
Degree12SVM = ifelse(predict(svm_model_polynomialD12) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_radial_cost1 <- svm(Label ~ X + Y, df, kernel = 'radial', cost = 1)
paste("Radial Cost 1 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost1) > 0, 1, 0))))
svm_model_radial_cost2 <- svm(Label ~ X + Y, df, kernel = 'radial', cost = 2)
paste("Radial Cost 2 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost2) > 0, 1, 0))))
svm_model_radial_cost3 <- svm(Label ~ X + Y, df, kernel = 'radial', cost = 3)
paste("Radial Cost 3 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost3) > 0, 1, 0))))
svm_model_radial_cost4 <- svm(Label ~ X + Y, df, kernel = 'radial', cost = 4)
paste("Radial Cost 4 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost4) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(Cost1SVM = ifelse(predict(svm_model_radial_cost1) > 0, 1, 0),
Cost2SVM = ifelse(predict(svm_model_radial_cost2) > 0, 1, 0),
Cost3SVM = ifelse(predict(svm_model_radial_cost3) > 0, 1, 0),
Cost4SVM = ifelse(predict(svm_model_radial_cost4) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_sigmoid_gamma1 <- svm(Label ~ X + Y, df, kernel = 'sigmoid', gamma = 1)
paste("sigmoid gamma 1 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma1) > 0, 1, 0))))
svm_model_sigmoid_gamma2 <- svm(Label ~ X + Y, df, kernel = 'sigmoid', gamma = 2)
paste("sigmoid gamma 2 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma2) > 0, 1, 0))))
svm_model_sigmoid_gamma3 <- svm(Label ~ X + Y, df, kernel = 'sigmoid', gamma = 3)
paste("sigmoid gamma 3 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma3) > 0, 1, 0))))
svm_model_sigmoid_gamma4 <- svm(Label ~ X + Y, df, kernel = 'sigmoid', gamma = 4)
paste("sigmoid gamma 4 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma4) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(gamma1SVM = ifelse(predict(svm_model_sigmoid_gamma1) > 0, 1, 0),
gamma2SVM = ifelse(predict(svm_model_sigmoid_gamma2) > 0, 1, 0),
gamma3SVM = ifelse(predict(svm_model_sigmoid_gamma3) > 0, 1, 0),
gamma4SVM = ifelse(predict(svm_model_sigmoid_gamma4) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
load('data/dtm.RData')
set.seed(1)
train_indices <- sort(sample(1:nrow(dtm), round(.5*nrow(dtm))))
test_indices <- which(! 1:nrow(dtm) %in% train_indices)
train_x <- dtm[train_indices, 3:ncol(dtm)]
train_y <- dtm[train_indices, 1]
test_x <- dtm[test_indices, 3:ncol(dtm)]
test_y <- dtm[test_indices, 1]
rm(dtm)
library('glmnet')
regularized_logistic_regression <- glmnet(train_x, train_y, family = "binomial")
(lambdas <- regularized_logistic_regression$lambda)
performance <- data.frame()
for (lambda in  lambdas) {
# test model on new test data with each lambda
temp_predictions <- predict(regularized_logistic_regression, test_x, s = lambda)
predictions <- as.numeric(temp_predictions > 0)
# calculate MSE
mse <- mean(predictions != test_y)
# add row back to DF
performance <- rbind(performance, data.frame(Lambda = lambda, MSE = mse))
}
ggplot(performance, aes(Lambda, MSE)) +
geom_point() +
scale_x_log10()
final_lambda <- with(performance, max(Lambda[which(MSE == min(MSE))]))
final_lambda <- with(performance, max(Lambda[which(MSE == min(MSE))]))
(final_lambda <- with(performance, max(Lambda[which(MSE == min(MSE))])))
(mse <- with(subset(performance, Lambda == final_lambda), MSE))
library(e1071)
linear_svm_model <- svm(train_x, train_y, kernel = 'linear')
temp_predictions_svm <- predict(linear_svm_model, text_x) %>%
predictions_svm <- as.numeric(temp_predictions_svm > 0)
temp_predictions_svm <- predict(linear_svm_model, text_x)
temp_predictions_svm <- predict(linear_svm_model, texst_x)
temp_predictions_svm <- predict(linear_svm_model, test_x)
predictions_svm <- as.numeric(temp_predictions_svm > 0)
(mse <- mean(predictions_svm != test_y))
radial_svm_model <- svm(train_x, train_y, kernel = 'radial')
temp_predictions_svm <- predict(radial_svm_model, test_x)
predictions_svm <- as.numeric(temp_predictions_svm > 0)
(mse <- mean(predictions_svm != test_y))
?knn
?svm
library(tidyverse)
library(ggplot2)
library(magrittr)
library(e1071)
library(reshape)
df <- read.csv('./data/df.csv')
logistic_model <- glm(formula = Label ~ X + Y, family = binomial(link = 'logit'), df)
logistic_predictions <- ifelse(predict(logistic_model) > 0, 1, 0)
# get accuracy compared to real data labels
mean(with(df, logistic_predictions == Label))
mean(with(df, 0 == Label))
library('e1071')
svm_model <- svm(formula = Label ~ X + Y, df)
svm_predictions <- ifelse(predict(svm_model) > 0, 1, 0)
mean(with(df, svm_predictions == Label))
df <- cbind(df,
data.frame(Logit = ifelse(predict(logistic_model) > 0, 1, 0), # logistic regression prediction
SVM = ifelse(predict(svm_model) > 0, 1, 0))) # SVM prediction
head(df)
# create new df where cols melt into single col's values
predictions <- melt(df, id.vars = c('X', 'Y'))
head(predictions)
ggplot(predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
# reset df
df <- df[, c('X', 'Y', 'Label')]
linear_svm <- svm(formula = Label ~ X + Y, df, kernel = 'linear')
with(df, mean(Label == ifelse(predict(linear_svm) > 0, 1, 0)))
polynomial_svm <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial')
with(df, mean(Label == ifelse(predict(polynomial_svm) > 0, 1, 0)))
radial_svm <- svm(formula = Label ~ X + Y, df, kernel = 'radial')
with(df, mean(Label == ifelse(predict(radial_svm) > 0, 1, 0)))
sigmoid_svm <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid')
with(df, mean(Label == ifelse(predict(sigmoid_svm) > 0, 1, 0)))
df <- cbind(df, data.frame(LinearSVM = ifelse(predict(linear_svm) > 0, 1, 0),
PolynomialSVM = ifelse(predict(polynomial_svm) > 0, 1, 0),
RadialSVM = ifelse(predict(radial_svm) > 0, 1, 0),
SigmoidSVM = ifelse(predict(sigmoid_svm) > 0, 1, 0)))
# melt each SVM col into single col
predictions <- melt(df, id.vars = c('X', 'Y'))
ggplot(predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_polynomialD3 <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial', degree = 3)
paste("3rd degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD3) > 0, 1, 0))))
svm_model_polynomialD5 <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial', degree = 5)
paste("5th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD5) > 0, 1, 0))))
svm_model_polynomialD10 <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial', degree = 10)
paste("10th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD10) > 0, 1, 0))))
svm_model_polynomialD12 <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial', degree = 12)
paste("12th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD12) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(Degree3SVM = ifelse(predict(svm_model_polynomialD3) > 0, 1, 0),
Degree5SVM = ifelse(predict(svm_model_polynomialD5) > 0, 1, 0),
Degree10SVM = ifelse(predict(svm_model_polynomialD10) > 0, 1, 0),
Degree12SVM = ifelse(predict(svm_model_polynomialD12) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_radial_cost1 <- svm(formula = Label ~ X + Y, df, kernel = 'radial', cost = 1)
paste("Radial Cost 1 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost1) > 0, 1, 0))))
svm_model_radial_cost2 <- svm(formula = Label ~ X + Y, df, kernel = 'radial', cost = 2)
paste("Radial Cost 2 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost2) > 0, 1, 0))))
svm_model_radial_cost3 <- svm(formula = Label ~ X + Y, df, kernel = 'radial', cost = 3)
paste("Radial Cost 3 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost3) > 0, 1, 0))))
svm_model_radial_cost4 <- svm(formula = Label ~ X + Y, df, kernel = 'radial', cost = 4)
paste("Radial Cost 4 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost4) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(Cost1SVM = ifelse(predict(svm_model_radial_cost1) > 0, 1, 0),
Cost2SVM = ifelse(predict(svm_model_radial_cost2) > 0, 1, 0),
Cost3SVM = ifelse(predict(svm_model_radial_cost3) > 0, 1, 0),
Cost4SVM = ifelse(predict(svm_model_radial_cost4) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_sigmoid_gamma1 <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid', gamma = 1)
paste("sigmoid gamma 1 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma1) > 0, 1, 0))))
svm_model_sigmoid_gamma2 <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid', gamma = 2)
paste("sigmoid gamma 2 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma2) > 0, 1, 0))))
svm_model_sigmoid_gamma3 <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid', gamma = 3)
paste("sigmoid gamma 3 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma3) > 0, 1, 0))))
svm_model_sigmoid_gamma4 <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid', gamma = 4)
paste("sigmoid gamma 4 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma4) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(gamma1SVM = ifelse(predict(svm_model_sigmoid_gamma1) > 0, 1, 0),
gamma2SVM = ifelse(predict(svm_model_sigmoid_gamma2) > 0, 1, 0),
gamma3SVM = ifelse(predict(svm_model_sigmoid_gamma3) > 0, 1, 0),
gamma4SVM = ifelse(predict(svm_model_sigmoid_gamma4) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
load('data/dtm.RData')
set.seed(1)
train_indices <- sort(sample(1:nrow(dtm), round(.5*nrow(dtm))))
test_indices <- which(! 1:nrow(dtm) %in% train_indices)
train_x <- dtm[train_indices, 3:ncol(dtm)]
train_y <- dtm[train_indices, 1]
test_x <- dtm[test_indices, 3:ncol(dtm)]
test_y <- dtm[test_indices, 1]
rm(dtm)
library('glmnet')
regularized_logistic_regression <- glmnet(train_x, train_y, family = "binomial")
(lambdas <- regularized_logistic_regression$lambda)
performance <- data.frame()
for (lambda in  lambdas) {
# test model on new test data with each lambda
temp_predictions <- predict(regularized_logistic_regression, test_x, s = lambda)
predictions <- as.numeric(temp_predictions > 0)
# calculate MSE
mse <- mean(predictions != test_y)
# add row back to DF
performance <- rbind(performance, data.frame(Lambda = lambda, MSE = mse))
}
ggplot(performance, aes(Lambda, MSE)) +
geom_point() +
scale_x_log10()
(final_lambda <- with(performance, max(Lambda[which(MSE == min(MSE))])))
(mse <- with(subset(performance, Lambda == final_lambda), MSE))
library(e1071)
linear_svm_model <- svm(x = train_x, y = train_y, kernel = 'linear')
temp_predictions_svm <- predict(linear_svm_model, test_x)
predictions_svm <- as.numeric(temp_predictions_svm > 0)
(mse <- mean(predictions_svm != test_y))
radial_svm_model <- svm(x = train_x, y = train_y, kernel = 'radial')
temp_predictions_svm <- predict(radial_svm_model, test_x)
predictions_svm <- as.numeric(temp_predictions_svm > 0)
(mse <- mean(predictions_svm != test_y))
?predict
library(class)
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = 50)
#knn_predictions <- as.numeric(as.character(knn_model))
knn_model
library(class)
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = 50)
# model is vector of cluster #'s
knn_predictions <- as.numeric(as.character(knn_model))
(mse <- mean(knn_predictions != test.y))
library(class)
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = 50)
# model is vector of cluster #'s
knn_predictions <- as.numeric(as.character(knn_model))
(mse <- mean(knn_predictions != test_y))
knn_performance <- data.frame()
for (k in seq(5, 50, by = 50)) {
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = k)
knn_predictions <- as.numeric(as.character(knn_model))
(mse <- mean(knn_predictions != test_y))
knn_performance <- rbind(knn_performance, data.frame(K = k, MSE = mse))
}
(best_k <- with(knn_performance, K[which(MSE = min(MSE))]))
knn_performance <- data.frame()
for (k in seq(5, 50, by = 50)) {
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = k)
knn_predictions <- as.numeric(as.character(knn_model))
(mse <- mean(knn_predictions != test_y))
knn_performance <- rbind(knn_performance, data.frame(K = k, MSE = mse))
}
(best_k <- with(knn_performance, K[which(MSE = min(MSE)]))
knn_performance <- data.frame()
for (k in seq(5, 50, by = 50)) {
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = k)
knn_predictions <- as.numeric(as.character(knn_model))
(mse <- mean(knn_predictions != test_y))
knn_performance <- rbind(knn_performance, data.frame(K = k, MSE = mse))
}
(best_k <- with(knn_performance, K[which(MSE = min(MSE))]))
knn_performance <- data.frame()
for (k in seq(5, 50, by = 50)) {
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = k)
knn_predictions <- as.numeric(as.character(knn_model))
(mse <- mean(knn_predictions != test_y))
knn_performance <- rbind(knn_performance, data.frame(K = k, MSE = mse))
}
(best_k <- with(knn_performance, K[which(MSE == min(MSE))]))
(bst_mse <- with(subset(knn_performance, K == best_k), MSE))
library(tidyverse)
library(ggplot2)
library(magrittr)
library(e1071)
library(reshape)
df <- read.csv('./data/df.csv')
logistic_model <- glm(formula = Label ~ X + Y, family = binomial(link = 'logit'), df)
logistic_predictions <- ifelse(predict(logistic_model) > 0, 1, 0)
# get accuracy compared to real data labels
mean(with(df, logistic_predictions == Label))
mean(with(df, 0 == Label))
library('e1071')
svm_model <- svm(formula = Label ~ X + Y, df)
svm_predictions <- ifelse(predict(svm_model) > 0, 1, 0)
mean(with(df, svm_predictions == Label))
df <- cbind(df,
data.frame(Logit = ifelse(predict(logistic_model) > 0, 1, 0), # logistic regression prediction
SVM = ifelse(predict(svm_model) > 0, 1, 0))) # SVM prediction
head(df)
# create new df where cols melt into single col's values
predictions <- melt(df, id.vars = c('X', 'Y'))
head(predictions)
ggplot(predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
# reset df
df <- df[, c('X', 'Y', 'Label')]
linear_svm <- svm(formula = Label ~ X + Y, df, kernel = 'linear')
with(df, mean(Label == ifelse(predict(linear_svm) > 0, 1, 0)))
polynomial_svm <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial')
with(df, mean(Label == ifelse(predict(polynomial_svm) > 0, 1, 0)))
radial_svm <- svm(formula = Label ~ X + Y, df, kernel = 'radial')
with(df, mean(Label == ifelse(predict(radial_svm) > 0, 1, 0)))
sigmoid_svm <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid')
with(df, mean(Label == ifelse(predict(sigmoid_svm) > 0, 1, 0)))
df <- cbind(df, data.frame(LinearSVM = ifelse(predict(linear_svm) > 0, 1, 0),
PolynomialSVM = ifelse(predict(polynomial_svm) > 0, 1, 0),
RadialSVM = ifelse(predict(radial_svm) > 0, 1, 0),
SigmoidSVM = ifelse(predict(sigmoid_svm) > 0, 1, 0)))
# melt each SVM col into single col
predictions <- melt(df, id.vars = c('X', 'Y'))
ggplot(predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_polynomialD3 <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial', degree = 3)
paste("3rd degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD3) > 0, 1, 0))))
svm_model_polynomialD5 <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial', degree = 5)
paste("5th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD5) > 0, 1, 0))))
svm_model_polynomialD10 <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial', degree = 10)
paste("10th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD10) > 0, 1, 0))))
svm_model_polynomialD12 <- svm(formula = Label ~ X + Y, df, kernel = 'polynomial', degree = 12)
paste("12th degree polynomial accuracy:",
with(df, mean(Label != ifelse(predict(svm_model_polynomialD12) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(Degree3SVM = ifelse(predict(svm_model_polynomialD3) > 0, 1, 0),
Degree5SVM = ifelse(predict(svm_model_polynomialD5) > 0, 1, 0),
Degree10SVM = ifelse(predict(svm_model_polynomialD10) > 0, 1, 0),
Degree12SVM = ifelse(predict(svm_model_polynomialD12) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_radial_cost1 <- svm(formula = Label ~ X + Y, df, kernel = 'radial', cost = 1)
paste("Radial Cost 1 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost1) > 0, 1, 0))))
svm_model_radial_cost2 <- svm(formula = Label ~ X + Y, df, kernel = 'radial', cost = 2)
paste("Radial Cost 2 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost2) > 0, 1, 0))))
svm_model_radial_cost3 <- svm(formula = Label ~ X + Y, df, kernel = 'radial', cost = 3)
paste("Radial Cost 3 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost3) > 0, 1, 0))))
svm_model_radial_cost4 <- svm(formula = Label ~ X + Y, df, kernel = 'radial', cost = 4)
paste("Radial Cost 4 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_radial_cost4) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(Cost1SVM = ifelse(predict(svm_model_radial_cost1) > 0, 1, 0),
Cost2SVM = ifelse(predict(svm_model_radial_cost2) > 0, 1, 0),
Cost3SVM = ifelse(predict(svm_model_radial_cost3) > 0, 1, 0),
Cost4SVM = ifelse(predict(svm_model_radial_cost4) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
svm_model_sigmoid_gamma1 <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid', gamma = 1)
paste("sigmoid gamma 1 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma1) > 0, 1, 0))))
svm_model_sigmoid_gamma2 <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid', gamma = 2)
paste("sigmoid gamma 2 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma2) > 0, 1, 0))))
svm_model_sigmoid_gamma3 <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid', gamma = 3)
paste("sigmoid gamma 3 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma3) > 0, 1, 0))))
svm_model_sigmoid_gamma4 <- svm(formula = Label ~ X + Y, df, kernel = 'sigmoid', gamma = 4)
paste("sigmoid gamma 4 accuracy:",
with(df, mean(Label == ifelse(predict(svm_model_sigmoid_gamma4) > 0, 1, 0))))
df <- df[, c('X', 'Y', 'Label')]
df <- cbind(df,
data.frame(gamma1SVM = ifelse(predict(svm_model_sigmoid_gamma1) > 0, 1, 0),
gamma2SVM = ifelse(predict(svm_model_sigmoid_gamma2) > 0, 1, 0),
gamma3SVM = ifelse(predict(svm_model_sigmoid_gamma3) > 0, 1, 0),
gamma4SVM = ifelse(predict(svm_model_sigmoid_gamma4) > 0, 1, 0)))
# melt down cols for each SVM degress into single col
svm_predictions <- melt(df, id.vars = c("X","Y"))
ggplot(svm_predictions, aes(X, Y, color = factor(value))) +
geom_point() +
facet_grid(variable ~ .)
load('data/dtm.RData')
set.seed(1)
train_indices <- sort(sample(1:nrow(dtm), round(.5*nrow(dtm))))
test_indices <- which(! 1:nrow(dtm) %in% train_indices)
train_x <- dtm[train_indices, 3:ncol(dtm)]
train_y <- dtm[train_indices, 1]
test_x <- dtm[test_indices, 3:ncol(dtm)]
test_y <- dtm[test_indices, 1]
rm(dtm)
library('glmnet')
regularized_logistic_regression <- glmnet(train_x, train_y, family = "binomial")
(lambdas <- regularized_logistic_regression$lambda)
performance <- data.frame()
for (lambda in lambdas) {
# test model on new test data with each lambda
temp_predictions <- predict(regularized_logistic_regression, test_x, s = lambda)
predictions <- as.numeric(temp_predictions > 0)
# calculate MSE
mse <- mean(predictions != test_y)
# add row back to DF
performance <- rbind(performance, data.frame(Lambda = lambda, MSE = mse))
}
ggplot(performance, aes(Lambda, MSE)) +
geom_point() +
scale_x_log10()
(final_lambda <- with(performance, max(Lambda[which(MSE == min(MSE))])))
(logreg_mse <- with(subset(performance, Lambda == final_lambda), MSE))
library(e1071)
linear_svm_model <- svm(x = train_x, y = train_y, kernel = 'linear')
temp_predictions_svm <- predict(linear_svm_model, test_x)
predictions_svm <- as.numeric(temp_predictions_svm > 0)
(linear_svm_mse <- mean(predictions_svm != test_y))
radial_svm_model <- svm(x = train_x, y = train_y, kernel = 'radial')
temp_predictions_svm <- predict(radial_svm_model, test_x)
predictions_svm <- as.numeric(temp_predictions_svm > 0)
(radial_svm_mse <- mean(predictions_svm != test_y))
library(class)
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = 50)
# model is vector of cluster #'s
knn_predictions <- as.numeric(as.character(knn_model))
(mse <- mean(knn_predictions != test_y))
knn_performance <- data.frame()
for (k in seq(5, 50, by = 50)) {
knn_model <- knn(train = train_x, test = test_x, cl = train_y, k = k)
knn_predictions <- as.numeric(as.character(knn_model))
(mse <- mean(knn_predictions != test_y))
knn_performance <- rbind(knn_performance, data.frame(K = k, MSE = mse))
}
(best_k <- with(knn_performance, K[which(MSE == min(MSE))]))
(knn_best_mse <- with(subset(knn_performance, K == best_k), MSE))
paste("Logistic Regression MSE:", logreg_MSE)
paste("Logistic Regression MSE:", logreg_mse)
paste("Linear SVM MSE:", linear_svm_MSE)
paste("Logistic Regression MSE:", logreg_mse)
paste("Linear SVM MSE:", linear_svm_mse)
paste("Radial SVM MSE:", radial_svm_mse)
paste("kNN MSE:", kNN_best_mse)
paste("Logistic Regression MSE:", logreg_mse)
paste("Linear SVM MSE:", linear_svm_mse)
paste("Radial SVM MSE:", radial_svm_mse)
paste("kNN MSE:", knn_best_mse)
