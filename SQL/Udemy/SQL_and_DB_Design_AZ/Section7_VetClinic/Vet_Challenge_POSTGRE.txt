/***** Data Analyst for vet clinic who needs dispersed data combined and have analytics performed ********/

--1) Extract info on pet names + owner names
SELECT o.surname, o.name, CONCAT(o.name,' ',o.surname) as fullName, p.name as petName  
FROM owners o 
LEFT JOIN pets p on o.ownerid = p.ownerid;

--2) Which pets from the clinic had procedures performed on them (ONLY THOSE PETS W/ PROC)
SELECT pe.name petName, CONCAT(o.name,' ',o.surname) ownerName,
	ph.proceduretype proceduretype, ph.proceduredate procedureDate
FROM pets pe 
INNER JOIN procedurehistory ph on pe.petid = ph.petid
INNER JOIN owners o on pe.ownerid = o.ownerid
ORDER BY pe.petid; --see some pets had multiple procedures

/*****Procedures NOT from our clinic*****/
SELECT pe.name petName, CONCAT(o.name,' ',o.surname) ownerName,
	ph.proceduretype proceduretype, ph.proceduredate procedureDate
FROM pets pe 
INNER JOIN procedurehistory ph on pe.petid = ph.petid
INNER JOIN owners o on pe.ownerid = o.ownerid
ORDER BY pe.petid;

--3) Match up procedures to descriptions
SELECT ph.proceduredate procedureDate, ph.proceduretype, ph.proceduresubcode,
	pd.description, pd.price
FROM procedurehistory ph
LEFT JOIN proceduredetails pd on ph.proceduresubcode = pd.proceduresubcode AND ph.proceduretype = pd.proceduretype
ORDER BY ph.proceduredate

--4) Do the above but only for pets from the clinic
SELECT pe.name petName, ph.proceduredate procedureDate, ph.proceduretype, ph.proceduresubcode,
	pd.description, pd.price
FROM pets pe
INNER JOIN procedurehistory ph ON pe.petid = ph.petid
LEFT JOIN proceduredetails pd on ph.proceduresubcode = pd.proceduresubcode AND ph.proceduretype = pd.proceduretype
ORDER BY ph.proceduredate

--5) Extract table of individual costs/procedure prices for owner's of pets from the clinic w/ owner + procedure side-by-side
SELECT CONCAT(o.name,' ',o.surname) ownerName, pd.price/*, pe.name petName, ph.proceduredate procedureDate, ph.proceduretype, ph.proceduresubcode,
	pd.description*/
FROM owners o
LEFT JOIN pets pe ON o.ownerid = pe.ownerid
INNER JOIN procedurehistory ph ON pe.petid = ph.petid
LEFT JOIN proceduredetails pd on ph.proceduresubcode = pd.proceduresubcode AND ph.proceduretype = pd.proceduretype
ORDER BY ph.proceduredate

--6) Find pets w/ same 1st letter of name as owner
SELECT pe.name petName, CONCAT(o.name,' ',o.surname) ownerName,
	ph.proceduretype proceduretype, ph.proceduredate procedureDate
FROM pets pe 
LEFT JOIN procedurehistory ph on pe.petid = ph.petid
LEFT JOIN owners o on pe.ownerid = o.ownerid;

SELECT pe.name petName, o.name ownerName
FROM owners o
RIGHT JOIN pets pe on o.ownerid = pe.ownerid
WHERE LEFT(o.name,1) = LEFT(pe.name,1);